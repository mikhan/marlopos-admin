import{defineInterface as e}from"@directus/extensions-sdk";import{defineComponent as t,computed as r,resolveComponent as n,openBlock as a,createBlock as l,withCtx as o,createElementVNode as i,createElementBlock as s}from"vue";var u=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],d=e=>{let t=0;for(let r=0;r<e.length;r++){let n=e[r];t=83*t+u.indexOf(n)}return t},h=e=>{let t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},c=e=>{let t=Math.max(0,Math.min(1,e));return t<=.0031308?Math.trunc(12.92*t*255+.5):Math.trunc(255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5)},p=(e,t)=>(e=>e<0?-1:1)(e)*Math.pow(Math.abs(e),t),m=class extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}},f=e=>{let t=e>>8&255,r=255&e;return[h(e>>16),h(t),h(r)]},g=(e,t)=>{let r=Math.floor(e/361),n=Math.floor(e/19)%19,a=e%19;return[p((r-9)/9,2)*t,p((n-9)/9,2)*t,p((a-9)/9,2)*t]},v=(e,t,r,n)=>{(e=>{if(!e||e.length<6)throw new m("The blurhash string must be at least 6 characters");let t=d(e[0]),r=Math.floor(t/9)+1,n=t%9+1;if(e.length!==4+2*n*r)throw new m(`blurhash length mismatch: length is ${e.length} but it should be ${4+2*n*r}`)})(e),n|=1;let a=d(e[0]),l=Math.floor(a/9)+1,o=a%9+1,i=(d(e[1])+1)/166,s=new Array(o*l);for(let t=0;t<s.length;t++)if(0===t){let r=d(e.substring(2,6));s[t]=f(r)}else{let r=d(e.substring(4+2*t,6+2*t));s[t]=g(r,i*n)}let u=4*t,h=new Uint8ClampedArray(u*r);for(let e=0;e<r;e++)for(let n=0;n<t;n++){let a=0,i=0,d=0;for(let u=0;u<l;u++)for(let l=0;l<o;l++){let h=Math.cos(Math.PI*n*l/t)*Math.cos(Math.PI*e*u/r),c=s[l+u*o];a+=c[0]*h,i+=c[1]*h,d+=c[2]*h}let p=c(a),m=c(i),f=c(d);h[4*n+0+e*u]=p,h[4*n+1+e*u]=m,h[4*n+2+e*u]=f,h[4*n+3+e*u]=255}return h},b=t({props:{value:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["input"],setup(e){const t=40,n=r((()=>{if(null===e.value)return null;try{const r=v(e.value,t,t),n=new ImageData(r,t,t),a=document.createElement("canvas");return a.width=t,a.height=t,a.getContext("2d").putImageData(n,0,0),a.toDataURL()}catch{return}})),a=r((()=>void 0===n.value));return{src:n,imageError:a}}});const y={class:"preview"},w=["src"];var M=[],x=[];!function(e,t){if(e&&"undefined"!=typeof document){var r,n=!0===t.prepend?"prepend":"append",a=!0===t.singleTag,l="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(a){var o=M.indexOf(l);-1===o&&(o=M.push(l)-1,x[o]={}),r=x[o]&&x[o][n]?x[o][n]:x[o][n]=i()}else r=i();65279===e.charCodeAt(0)&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function i(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var r=Object.keys(t.attributes),a=0;a<r.length;a++)e.setAttribute(r[a],t.attributes[r[a]]);var o="prepend"===n?"afterbegin":"beforeend";return l.insertAdjacentElement(o,e),e}}("\n.preview[data-v-64969d30] {\n  --v-icon-color: var(--foreground-subdued);\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  margin-left: -8px;\n  overflow: hidden;\n  background-color: var(--background-normal);\n  border-radius: var(--border-radius);\n}\n.preview img[data-v-64969d30] {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n",{}),b.render=function(e,t,r,u,d,h){const c=n("v-icon"),p=n("value-null"),m=n("v-input");return a(),l(m,{disabled:e.disabled,"model-value":e.value,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("input",t))},{prepend:o((()=>[i("div",y,[e.imageError?(a(),l(c,{key:0,name:"image"})):e.src?(a(),s("img",{key:1,role:"presentation",width:"40",height:"40",src:e.src},null,8,w)):(a(),l(p,{key:2}))])])),_:1},8,["disabled","model-value"])},b.__scopeId="data-v-64969d30",b.__file="src/interface.vue";var E=e({id:"blurhash",name:"Blurhash",icon:"insert_photo",description:"A blurhash from image",component:b,options:null,types:["string","text"]});export{E as default};
