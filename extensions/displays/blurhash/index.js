import{defineDisplay as e}from"@directus/extensions-sdk";import{defineComponent as t,computed as r,resolveComponent as n,openBlock as a,createBlock as l,createElementBlock as s}from"vue";var o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],i=e=>{let t=0;for(let r=0;r<e.length;r++){let n=e[r];t=83*t+o.indexOf(n)}return t},u=e=>{let t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},h=e=>{let t=Math.max(0,Math.min(1,e));return t<=.0031308?Math.trunc(12.92*t*255+.5):Math.trunc(255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5)},c=(e,t)=>(e=>e<0?-1:1)(e)*Math.pow(Math.abs(e),t),d=class extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}},p=e=>{let t=e>>8&255,r=255&e;return[u(e>>16),u(t),u(r)]},f=(e,t)=>{let r=Math.floor(e/361),n=Math.floor(e/19)%19,a=e%19;return[c((r-9)/9,2)*t,c((n-9)/9,2)*t,c((a-9)/9,2)*t]},g=(e,t,r,n)=>{(e=>{if(!e||e.length<6)throw new d("The blurhash string must be at least 6 characters");let t=i(e[0]),r=Math.floor(t/9)+1,n=t%9+1;if(e.length!==4+2*n*r)throw new d(`blurhash length mismatch: length is ${e.length} but it should be ${4+2*n*r}`)})(e),n|=1;let a=i(e[0]),l=Math.floor(a/9)+1,s=a%9+1,o=(i(e[1])+1)/166,u=new Array(s*l);for(let t=0;t<u.length;t++)if(0===t){let r=i(e.substring(2,6));u[t]=p(r)}else{let r=i(e.substring(4+2*t,6+2*t));u[t]=f(r,o*n)}let c=4*t,g=new Uint8ClampedArray(c*r);for(let e=0;e<r;e++)for(let n=0;n<t;n++){let a=0,o=0,i=0;for(let h=0;h<l;h++)for(let l=0;l<s;l++){let c=Math.cos(Math.PI*n*l/t)*Math.cos(Math.PI*e*h/r),d=u[l+h*s];a+=d[0]*c,o+=d[1]*c,i+=d[2]*c}let d=h(a),p=h(o),f=h(i);g[4*n+0+e*c]=d,g[4*n+1+e*c]=p,g[4*n+2+e*c]=f,g[4*n+3+e*c]=255}return g},m=t({props:{value:{type:String,default:null}},setup(e){const t=32,n=r((()=>{if(null===e.value)return null;try{const r=g(e.value,t,t),n=new ImageData(r,t,t),a=document.createElement("canvas");return a.width=t,a.height=t,a.getContext("2d").putImageData(n,0,0),a.toDataURL()}catch{return}})),a=r((()=>void 0===n.value));return{src:n,imageError:a}}});const v=["src"];var b=[],y=[];!function(e,t){if(e&&"undefined"!=typeof document){var r,n=!0===t.prepend?"prepend":"append",a=!0===t.singleTag,l="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(a){var s=b.indexOf(l);-1===s&&(s=b.push(l)-1,y[s]={}),r=y[s]&&y[s][n]?y[s][n]:y[s][n]=o()}else r=o();65279===e.charCodeAt(0)&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function o(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var r=Object.keys(t.attributes),a=0;a<r.length;a++)e.setAttribute(r[a],t.attributes[r[a]]);var s="prepend"===n?"afterbegin":"beforeend";return l.insertAdjacentElement(s,e),e}}("\nimg[data-v-900f700e] {\n  display: inline-block;\n  width: auto;\n  height: 100%;\n  vertical-align: -30%;\n  border-radius: var(--border-radius);\n}\n",{}),m.render=function(e,t,r,o,i,u){const h=n("v-icon"),c=n("value-null");return e.imageError?(a(),l(h,{key:0,name:"image"})):e.src?(a(),s("img",{key:1,role:"presentation",width:"32",height:"32",src:e.src},null,8,v)):(a(),l(c,{key:2}))},m.__scopeId="data-v-900f700e",m.__file="src/display.vue";var M=e({id:"blurhash",name:"Blurhash",icon:"insert_photo",description:"Display an image preview",component:m,options:null,types:["string","text"],localTypes:["standard"],group:"standard"});export{M as default};
